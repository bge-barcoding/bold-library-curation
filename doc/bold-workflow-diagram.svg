<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="1500" viewBox="0 0 1200 1500">
  <defs>
    <!-- Gradients for different phases -->
    <linearGradient id="phase1" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#e8f4f8;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#d1e7f0;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="phase2" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#fff2e8;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ffe0cc;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="phase3" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f0f8e8;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#e1f2cc;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="phase4" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f8e8f8;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#f0ccf0;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="phase5" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#e8f8f0;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ccf2e1;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="phase6" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f8f0e8;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#f2e1cc;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="phase7" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f8e8f8;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#f0ccf0;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="phase8" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ffe8e8;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ffcccc;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="phase9" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#e8f8e8;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ccf2cc;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="phase10" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f8f8e8;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#f2f2cc;stop-opacity:1" />
    </linearGradient>
    
    <!-- Arrow marker -->
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="600" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#333">BOLD Library Curation Workflow</text>
  <text x="600" y="55" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" fill="#666">Snakemake Pipeline Architecture</text>
  
  <!-- Phase 1: Data Preparation -->
  <rect x="50" y="80" width="1100" height="120" rx="10" fill="url(#phase1)" stroke="#4a90e2" stroke-width="2"/>
  <text x="70" y="105" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#2c5282">Phase 1: Data Preparation &amp; Filtering</text>
  
  <!-- Input data -->
  <rect x="80" y="120" width="140" height="40" rx="5" fill="#ffffff" stroke="#4a90e2" stroke-width="1"/>
  <text x="150" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">BOLD TSV Input</text>
  
  <!-- Optional prescoring filter -->
  <rect x="280" y="120" width="180" height="40" rx="5" fill="#ffffff" stroke="#4a90e2" stroke-width="1" stroke-dasharray="5,5"/>
  <text x="370" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">Prescoring Filter</text>
  <text x="370" y="175" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">(Optional)</text>
  
  <!-- Phase 2: Database Setup -->
  <rect x="50" y="220" width="1100" height="120" rx="10" fill="url(#phase2)" stroke="#f6a623" stroke-width="2"/>
  <text x="70" y="245" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#8b4513">Phase 2: Database Creation &amp; Setup</text>
  
  <!-- Database creation steps -->  <rect x="80" y="265" width="120" height="40" rx="5" fill="#ffffff" stroke="#f6a623" stroke-width="1"/>
  <text x="140" y="290" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">Create &amp; Load DB</text>
  
  <rect x="230" y="265" width="120" height="40" rx="5" fill="#ffffff" stroke="#f6a623" stroke-width="1"/>
  <text x="290" y="290" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">Load Criteria</text>
  
  <rect x="380" y="265" width="120" height="40" rx="5" fill="#ffffff" stroke="#f6a623" stroke-width="1"/>
  <text x="440" y="290" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">Apply Indexes</text>
  
  <rect x="530" y="265" width="120" height="40" rx="5" fill="#ffffff" stroke="#f6a623" stroke-width="1"/>
  <text x="590" y="290" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">Load Taxonomy</text>
  
  <!-- Optional target list -->
  <rect x="680" y="265" width="140" height="40" rx="5" fill="#ffffff" stroke="#f6a623" stroke-width="1" stroke-dasharray="5,5"/>
  <text x="750" y="290" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">Target List</text>
  <text x="750" y="320" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">(Optional)</text>
  
  <!-- Phase 3: Quality Assessment -->
  <rect x="50" y="360" width="1100" height="210" rx="10" fill="url(#phase3)" stroke="#7ed321" stroke-width="2"/>
  <text x="70" y="385" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#4a5d23">Phase 3: Quality Criteria Assessment</text>
  
  <!-- Grid of criteria assessments -->
  <g id="criteria-grid">
    <!-- Row 1 -->
    <rect x="80" y="405" width="110" height="35" rx="3" fill="#ffffff" stroke="#7ed321" stroke-width="1"/>
    <text x="135" y="427" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">COLLECTION_DATE</text>
    
    <rect x="210" y="405" width="110" height="35" rx="3" fill="#ffffff" stroke="#7ed321" stroke-width="1"/>
    <text x="265" y="427" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">COLLECTORS</text>
    
    <rect x="340" y="405" width="110" height="35" rx="3" fill="#ffffff" stroke="#7ed321" stroke-width="1"/>
    <text x="395" y="427" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">COUNTRY</text>
    
    <rect x="470" y="405" width="110" height="35" rx="3" fill="#ffffff" stroke="#7ed321" stroke-width="1"/>
    <text x="525" y="427" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">ID_METHOD</text>
    
    <rect x="600" y="405" width="110" height="35" rx="3" fill="#ffffff" stroke="#7ed321" stroke-width="1"/>
    <text x="655" y="427" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">IDENTIFIER</text>
    
    <rect x="730" y="405" width="110" height="35" rx="3" fill="#ffffff" stroke="#7ed321" stroke-width="1"/>
    <text x="785" y="427" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">INSTITUTION</text>
    
    <rect x="860" y="405" width="110" height="35" rx="3" fill="#ffffff" stroke="#7ed321" stroke-width="1"/>
    <text x="915" y="427" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">COORD</text>
    
    <rect x="990" y="405" width="110" height="35" rx="3" fill="#ffffff" stroke="#7ed321" stroke-width="1"/>
    <text x="1045" y="427" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">MUSEUM_ID</text>
    
    <!-- Row 2 -->
    <rect x="80" y="460" width="110" height="35" rx="3" fill="#ffffff" stroke="#7ed321" stroke-width="1"/>
    <text x="135" y="482" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">PUBLIC_VOUCHER</text>
    
    <rect x="210" y="460" width="110" height="35" rx="3" fill="#ffffff" stroke="#7ed321" stroke-width="1"/>
    <text x="265" y="482" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">SEQ_QUALITY</text>
    
    <rect x="340" y="460" width="110" height="35" rx="3" fill="#ffffff" stroke="#7ed321" stroke-width="1"/>
    <text x="395" y="482" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">SITE</text>
    
    <rect x="470" y="460" width="110" height="35" rx="3" fill="#ffffff" stroke="#7ed321" stroke-width="1"/>
    <text x="525" y="482" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">REGION</text>
    
    <rect x="600" y="460" width="110" height="35" rx="3" fill="#ffffff" stroke="#7ed321" stroke-width="1"/>
    <text x="655" y="482" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">SECTOR</text>
    
    <rect x="730" y="460" width="110" height="35" rx="3" fill="#ffffff" stroke="#7ed321" stroke-width="1"/>
    <text x="785" y="482" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">SPECIES_ID</text>
    
    <rect x="860" y="460" width="110" height="35" rx="3" fill="#ffffff" stroke="#7ed321" stroke-width="1"/>
    <text x="915" y="482" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">TYPE_SPECIMEN</text>
    
    <rect x="990" y="460" width="110" height="35" rx="3" fill="#ffffff" stroke="#7ed321" stroke-width="1"/>
    <text x="1045" y="482" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">HAS_IMAGE</text>
    
    <!-- Row 3 - Special analyses -->
   
    <rect x="210" y="515" width="110" height="35" rx="3" fill="#ffffff" stroke="#7ed321" stroke-width="1"/>
    <text x="265" y="537" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">OTU_CLUSTERING</text>
    
  </g>
  
  <!-- Phase 4: BAGS assessment -->
  <rect x="50" y="590" width="1100" height="105" rx="10" fill="url(#phase5)" stroke="#50e3c2" stroke-width="2"/>
  <text x="70" y="615" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#1a4d3a">Phase 4: BAGS assessment</text>
  
  <rect x="80" y="635" width="130" height="40" rx="5" fill="#ffffff" stroke="#50e3c2" stroke-width="1"/>
  <text x="145" y="660" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">Optimize BAGS</text>
  
  <rect x="240" y="635" width="130" height="40" rx="5" fill="#ffffff" stroke="#50e3c2" stroke-width="1"/>
  <text x="305" y="660" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">BAGS assessment</text>
  
  <rect x="400" y="635" width="130" height="40" rx="5" fill="#ffffff" stroke="#50e3c2" stroke-width="1"/>
  <text x="465" y="660" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">import BAGS</text>
  
  <rect x="560" y="635" width="140" height="40" rx="5" fill="#ffffff" stroke="#50e3c2" stroke-width="1"/>
  <text x="630" y="660" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">Inherit Subspecies BAGS</text>
    
  <!-- Phase 5: Data Integration -->
  <rect x="50" y="790" width="1100" height="110" rx="10" fill="url(#phase5)" stroke="#50e3c2" stroke-width="2"/>
  <text x="70" y="815" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#1a4d3a">Phase 5: Data Integration</text>
  
  <!-- Concatenate Criteria -->
  <rect x="80" y="835" width="150" height="40" rx="5" fill="#ffffff" stroke="#50e3c2" stroke-width="1"/>
  <text x="155" y="860" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">Concatenate Criteria</text>
  
  <!-- Import Criteria Scores -->
  <rect x="270" y="835" width="200" height="40" rx="5" fill="#ffffff" stroke="#50e3c2" stroke-width="1"/>
  <text x="370" y="860" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">Import Criteria Scores</text>
  
  <!-- Import OTUs -->
  <rect x="510" y="835" width="150" height="40" rx="5" fill="#ffffff" stroke="#50e3c2" stroke-width="1"/>
  <text x="585" y="860" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">Import OTUs</text>
  
  <!-- Phase 6: Phylogenetic Analyses -->
  <rect x="50" y="920" width="1100" height="120" rx="10" fill="url(#phase6)" stroke="#f39c12" stroke-width="2"/>
  <text x="70" y="945" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#8b4513">Phase 6: Phylogenetic Analyses</text>
  
  <rect x="80" y="965" width="120" height="40" rx="5" fill="#ffffff" stroke="#f39c12" stroke-width="1"/>
  <text x="140" y="990" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">Prepare batches</text>
  
  <rect x="220" y="965" width="120" height="40" rx="5" fill="#ffffff" stroke="#f39c12" stroke-width="1"/>
  <text x="280" y="990" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">Run analyses</text>
   
  <!-- Phase 7: Specimen Ranking -->
  <rect x="50" y="1060" width="1100" height="80" rx="10" fill="url(#phase7)" stroke="#9b59b6" stroke-width="2"/>
  <text x="70" y="1085" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#6b46c1">Phase 7: Specimen Ranking &amp; Selection</text>
  
  <rect x="80" y="1100" width="140" height="30" rx="3" fill="#ffffff" stroke="#9b59b6" stroke-width="1"/>
  <text x="150" y="1120" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">Calculate Ranks</text>
  
  <rect x="240" y="1100" width="140" height="30" rx="3" fill="#ffffff" stroke="#9b59b6" stroke-width="1"/>
  <text x="310" y="1120" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">Calculate Scores</text>
  
  <rect x="400" y="1100" width="140" height="30" rx="3" fill="#ffffff" stroke="#9b59b6" stroke-width="1"/>
  <text x="470" y="1120" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">Select Representatives</text>
  
  <!-- Phase 8: Family Database Creation -->
  <rect x="50" y="1160" width="1100" height="120" rx="10" fill="url(#phase8)" stroke="#e74c3c" stroke-width="2"/>
  <text x="70" y="1185" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#c0392b">Phase 8: Parallel Family Database Creation</text>
  
  <!-- Family splitting with SLURM -->
  <rect x="80" y="1205" width="160" height="40" rx="5" fill="#ffffff" stroke="#e74c3c" stroke-width="1"/>
  <text x="160" y="1230" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">Prepare Batches</text>
  
  <rect x="270" y="1205" width="200" height="40" rx="5" fill="#ffffff" stroke="#e74c3c" stroke-width="1"/>
  <text x="370" y="1230" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">Split Database</text>
  
  <!-- Integration -->
  <rect x="500" y="1205" width="160" height="40" rx="5" fill="#ffffff" stroke="#e74c3c" stroke-width="1"/>
  <text x="580" y="1230" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">Integrate Phylogenies</text>
  
  <!-- Compression -->
  <rect x="690" y="1205" width="160" height="40" rx="5" fill="#ffffff" stroke="#e74c3c" stroke-width="1"/>
  <text x="770" y="1230" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">Compress Archives</text>
  
  <!-- Phase 9: Statistics & Reporting -->
  <rect x="50" y="1300" width="1100" height="80" rx="10" fill="url(#phase9)" stroke="#27ae60" stroke-width="2"/>
  <text x="70" y="1325" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#1e8449">Phase 9: Statistical Reporting</text>
  
  <rect x="80" y="1340" width="180" height="30" rx="3" fill="#ffffff" stroke="#27ae60" stroke-width="1"/>
  <text x="170" y="1360" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">Generate Stats Report</text>
  
  <rect x="280" y="1340" width="180" height="30" rx="3" fill="#ffffff" stroke="#27ae60" stroke-width="1"/>
  <text x="370" y="1360" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">PDF Visualization</text>
  
  <!-- Phase 10: Final Archiving -->
  <rect x="50" y="1400" width="1100" height="80" rx="10" fill="url(#phase10)" stroke="#f1c40f" stroke-width="2"/>
  <text x="70" y="1425" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#b7950b">Phase 10: Final Results Archiving</text>
  
  <rect x="80" y="1440" width="160" height="30" rx="3" fill="#ffffff" stroke="#f1c40f" stroke-width="1"/>
  <text x="160" y="1460" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#333">Timestamped Archive</text>
  
</svg>